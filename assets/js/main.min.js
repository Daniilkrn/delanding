const talkBtn=document.querySelector(".btn_talk");let form=document.querySelector(".form"),email=document.querySelector(".email"),area=document.querySelector(".area"),nickForm=document.querySelector(".nick"),body=document.querySelector("body"),modal=document.querySelector(".modal"),closeModal=document.querySelector(".close"),closeModalSent=document.querySelector(".close2"),modalSent=document.querySelector(".modalConfirm"),modalSentBox=document.querySelector(".modalConfrim_box"),modalBox=document.querySelector(".modal_box");function validateEmail(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}let inputs=[{validate:!0,error:"обязательное поле!"},{validate:!0,error:"обязательное поле!"},{validate:!0,error:"обязательное поле!"}];function validation(e){let i=[],s={validationAll:!1,validationEmail:!1};function r(e,o){var t=e.parentNode,l=document.createElement("p");l.classList.add("errorText"),l.textContent=o,e.classList.add("error"),t.append(l)}if(e.querySelectorAll("input").forEach((e,o)=>{var t,l;l=(t=e).closest("label").querySelector(".errorText"),t.classList.contains("error")&&(l.remove(),l.classList.remove(".errorText"),t.classList.remove("error"));let a;1===o&&((a=validateEmail(e.value))?s.validationEmail=!0:r(e,"введите ваш e-mail!")),""==e.value.trim()?1!==o&&r(e,"обязательное поле!"):(i.push(o),a&&1<i.length&&(s.validationAll=!0))}),s.validationAll&&s.validationEmail)return!0}async function submitHandler(o){o.classList.add("sending");let t=document.createElement("div");t.className="sendingDiv",t.innerHTML=`
    <div class="lds-roller"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
    `,o.append(t),await fetch("https://jsonplaceholder.typicode.com/posts",{method:"POST",body:JSON.stringify({title:"testTitle",body:"testBody",userId:1}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then(e=>e.json()).then(e=>{e?scrollController.setMessageModal():(o.classList.remove("sending"),o.removeChild(t))}).finally(()=>{o.classList.remove("sending"),o.removeChild(t),o.reset()})}const scrollController={position:0,flag:!(form.onsubmit=function(e){e.preventDefault(),1==validation(this)&&submitHandler(this)}),disabled(){var e=window.scrollY;body.classList.add("openBody"),modal.classList.add("open"),this.position=e,this.flag=!0,confirmPos(this.position)},enabled(){return modal.classList.remove("open"),body.classList.remove("openBody"),confirmPos(this.position,this.flag)},setMessageModal(){modal.classList.remove("open"),modalSent.classList.add("open")},disableMessageModal(){modalSent.classList.remove("open"),confirmPos(this.position,this.flag)}};function confirmPos(e,o){window.scrollTo({top:e,left:0})}talkBtn.addEventListener("click",()=>{scrollController.disabled()}),closeModal.addEventListener("click",()=>{scrollController.enabled()}),closeModalSent.addEventListener("click",()=>{scrollController.disableMessageModal()}),modal.addEventListener("click",()=>{scrollController.enabled()}),modalBox.addEventListener("click",e=>{e.stopPropagation()}),modalSentBox.addEventListener("click",e=>{e.stopPropagation()}),modalSent.addEventListener("click",()=>{scrollController.disableMessageModal()});